
# 상속관계 매핑

- 관계형 DB는 상속 관계 X
- 슈퍼타입 서브타입 관계 모델링 = 객체 상속과 유사
- 객체의 상속구조와 DB의 슈퍼타입 서브타입 관계를 매핑

### 논리 모델을 실제 물리 모델로 구현하는 방법

1. 각각 테이블로 변환 ⇒ 조인 전략
2. 통합 테이블로 변환 ⇒ 단일 테이블 전략
3. 서브타입 테이블로 변환 ⇒ 구현 클래스마다 테이블 전략

## 조인 전략

### 장점

- 테이블 정규화
- 외래 키 참조 무결성 제약조건 활용가능
- 저장공간 효율화

### 단점

- 조회 시 조인을 많이 사용 ⇒ 성능 저하
- 조회 쿼리가 복잡
- 데이터 저장 시 INSERT 2번 호출

 

## 단일 테이블 전략

### 장점

- 조인 필요 X ⇒ 조회 성능 빠름
- 조회 쿼리 단순

### 단점

- 자식 엔티티 매핑한 컬럼 모두 null 허용
- 테이블이 커질 수 있다 ⇒ 조회 성능 저하

### @DistcriminatorColumn

- 상속관계 테이블에서 하위테이블의 구분 열 지정 시 사용
- name의 기본 값 DTYPE
- Type의 기본 값 String
- 하위 테이블은 @DiscriminatorValue 사용

## 구현 클래스마다 테이블 전략

- 추천하지 않는 방식

### 장점

- 서브 타입을 명확하게 구분, 처리할 때 효과적
- not null 조건 가능

### 단점

- 여러 자식 테이블 함께 조회 시 성능 저하
- 자식 테이블 통합 쿼리 어려움

# 정리

기본적으로 조인 전략이 정석, 설계가 깔끔하다

하지만 성능과 구조가 간단한 단일 테이블 전략이 편리 (임계점에서 성능저하)

구현클래스 테이블 전략은 쓰지말자
